name: Convert Resume to PDF

permissions:
  contents: write

on:
  push:
    branches:
      - main
    paths:
      - 'markdowns/resume_eng.md'
      - 'markdowns/resume_ger.md'

jobs:
  convert:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v4
      
      - name: Setup Pandoc
        run: |
          sudo apt-get update
          sudo apt-get install -y pandoc texlive-latex-base texlive-fonts-recommended texlive-extra-utils texlive-latex-extra
      
      - name: Convert MD to PDF
        run: |
          # Create pdfs directory if it doesn't exist
          mkdir -p pdfs
          
          # Convert English resume if it exists
          if [ -f "markdowns/resume_eng.md" ]; then
            echo "Converting English resume"
            pandoc markdowns/resume_eng.md -o pdfs/resume_eng.pdf
          fi
          
          # Convert German resume if it exists
          if [ -f "markdowns/resume_ger.md" ]; then
            echo "Converting German resume"
            pandoc markdowns/resume_ger.md -o pdfs/resume_ger.pdf
          fi
      
      - name: Commit PDF
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          
          # Add PDFs if they exist
          if [ -f "pdfs/resume_eng.pdf" ]; then
            git add pdfs/resume_eng.pdf
          fi
          if [ -f "pdfs/resume_ger.pdf" ]; then
            git add pdfs/resume_ger.pdf
          fi
          
          git commit -m "Auto-generate PDF from markdown" || exit 0
          git push 